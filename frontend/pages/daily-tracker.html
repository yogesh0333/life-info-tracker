<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Tracker - <span data-user-name>Life</span> Blueprint</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Auth Guard -->
    <script src="auth-guard.js"></script>
    <script src="../config.js"></script>
    <script src="../js/userData.js"></script>
    <script src="../js/pageInit.js"></script>
    
    <style>
        :root {
            --primary: #6366f1;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }
        
        body {
            background: #f8fafc;
            font-family: 'Inter', sans-serif;
        }
        
        .tracker-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }
        
        .category-tab {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            background: white;
            transition: all 0.3s ease;
        }
        
        .category-tab:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .category-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .save-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        
        .nav-pills .nav-link {
            border-radius: 10px;
            margin: 0.2rem;
        }
        
        .nav-pills .nav-link.active {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-12">
                <!-- Header -->
                <div class="tracker-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h1 class="mb-2"><i class="fas fa-calendar-day me-2"></i>Daily Tracker</h1>
                            <p class="mb-0" id="currentDate"></p>
                        </div>
                        <div class="text-end">
                            <h2 class="mb-0" id="dailyScore">0/100</h2>
                            <small>Today's Score</small>
                        </div>
                    </div>
                </div>

                <!-- Navigation Tabs -->
                <ul class="nav nav-pills mb-4" id="categoryTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="career-tab" data-bs-toggle="pill" data-bs-target="#career" type="button">
                            üíº Career
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="health-tab" data-bs-toggle="pill" data-bs-target="#health" type="button">
                            üí™ Health
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="spiritual-tab" data-bs-toggle="pill" data-bs-target="#spiritual" type="button">
                            üôè Spiritual
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="finance-tab" data-bs-toggle="pill" data-bs-target="#finance" type="button">
                            üí∞ Finance
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="family-tab" data-bs-toggle="pill" data-bs-target="#family" type="button">
                            üë®‚Äçüë©‚Äçüëß Family
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="vehicle-tab" data-bs-toggle="pill" data-bs-target="#vehicle" type="button">
                            üöó Vehicle
                        </button>
                    </li>
                </ul>

                <!-- Tab Content -->
                <div class="tab-content" id="trackerContent">
                    <!-- Career Tab -->
                    <div class="tab-pane fade show active" id="career" role="tabpanel">
                        <div class="category-tab">
                            <div class="category-icon">üíº</div>
                            <h3>Career & Work</h3>
                            
                            <div class="row g-3 mt-3">
                                <div class="col-md-4">
                                    <label class="form-label">Hours Worked</label>
                                    <input type="number" class="form-control" id="hoursWorked" min="0" max="24" placeholder="8">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">LeetCode Problems</label>
                                    <input type="number" class="form-control" id="leetcodeProblems" min="0" placeholder="3">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Learning Hours</label>
                                    <input type="number" class="form-control" id="learningHours" min="0" max="24" placeholder="2">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Projects Worked On</label>
                                    <input type="text" class="form-control" id="projectsWorked" placeholder="Project names">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Job Applications</label>
                                    <input type="number" class="form-control" id="jobApplications" min="0" placeholder="0">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Interviews</label>
                                    <input type="number" class="form-control" id="interviews" min="0" placeholder="0">
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Career Notes</label>
                                    <textarea class="form-control" id="careerNotes" rows="2" placeholder="Progress, achievements, challenges..."></textarea>
                                </div>
                            </div>

                            <!-- Career Goals from MD files -->
                            <div class="alert alert-info mt-4">
                                <strong>üéØ Career Goals:</strong>
                                <ul class="mb-0 mt-2">
                                    <li>Current: ‚Çπ24 LPA (‚Çπ2L/month)</li>
                                    <li>2027 Target: ‚Çπ40 LPA (Bangalore move)</li>
                                    <li>2030 Target: ‚Çπ1 Cr net worth</li>
                                    <li>Focus: 500+ LeetCode, System Design, Projects</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Health Tab -->
                    <div class="tab-pane fade" id="health" role="tabpanel">
                        <div class="category-tab">
                            <div class="category-icon">üí™</div>
                            <h3>Health & Fitness</h3>
                            
                            <div class="row g-3 mt-3">
                                <div class="col-md-3">
                                    <label class="form-label">Weight (kg)</label>
                                    <input type="number" class="form-control" id="weight" step="0.1" placeholder="91">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Cardio (min)</label>
                                    <input type="number" class="form-control" id="cardio" min="0" placeholder="30">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Strength (min)</label>
                                    <input type="number" class="form-control" id="strength" min="0" placeholder="20">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Yoga (min)</label>
                                    <input type="number" class="form-control" id="yoga" min="0" placeholder="10">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Calories</label>
                                    <input type="number" class="form-control" id="calories" placeholder="2000">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Water (glasses)</label>
                                    <input type="number" class="form-control" id="water" min="0" max="20" placeholder="8">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Sleep (hours)</label>
                                    <input type="number" class="form-control" id="sleep" min="0" max="24" step="0.5" placeholder="7">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Mood</label>
                                    <select class="form-select" id="mood">
                                        <option value="excellent">üòÅ Excellent</option>
                                        <option value="good" selected>üòä Good</option>
                                        <option value="okay">üòê Okay</option>
                                        <option value="bad">üòü Bad</option>
                                        <option value="terrible">üò¢ Terrible</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Meals</label>
                                    <textarea class="form-control" id="meals" rows="2" placeholder="Breakfast: ... | Lunch: ... | Dinner: ..."></textarea>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Health Notes</label>
                                    <textarea class="form-control" id="healthNotes" rows="2" placeholder="How you felt, supplements taken..."></textarea>
                                </div>
                            </div>

                            <!-- Health Goals -->
                            <div class="alert alert-warning mt-4">
                                <strong>üéØ Health Goals:</strong>
                                <ul class="mb-0 mt-2">
                                    <li>Current Weight: 91 kg ‚Üí Target: 70 kg</li>
                                    <li>Timeline: 12 months (Nov 2025 - Nov 2026)</li>
                                    <li>Exercise: 3 days cardio + 3 days strength</li>
                                    <li>Diet: 2 rotis lunch/dinner, light meals</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Spiritual Tab -->
                    <div class="tab-pane fade" id="spiritual" role="tabpanel">
                        <div class="category-tab">
                            <div class="category-icon">üôè</div>
                            <h3>Spiritual Practice</h3>
                            
                            <div class="row g-3 mt-3">
                                <div class="col-md-3">
                                    <label class="form-label">Hanuman Chalisa (times)</label>
                                    <input type="number" class="form-control" id="hanumanChalisa" min="0" placeholder="2">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Meditation (min)</label>
                                    <input type="number" class="form-control" id="meditation" min="0" placeholder="10">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Prayer (min)</label>
                                    <input type="number" class="form-control" id="prayer" min="0" placeholder="5">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Temple Visit</label>
                                    <select class="form-select" id="templeVisit">
                                        <option value="false">No</option>
                                        <option value="true">Yes</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Spiritual Notes</label>
                                    <textarea class="form-control" id="spiritualNotes" rows="2" placeholder="Mantras, prayers, insights..."></textarea>
                                </div>
                            </div>

                            <!-- Spiritual Reminders -->
                            <div class="alert alert-success mt-4">
                                <strong>üôè Daily Practice (Mars in 12th Protection):</strong>
                                <ul class="mb-0 mt-2">
                                    <li>Morning: Hanuman Chalisa (protect from accidents)</li>
                                    <li>Before driving: "Om Hanumate Namaha" 11 times</li>
                                    <li>Tuesday: Hanuman temple visit (weekly)</li>
                                    <li>Red thread: Right wrist (always wear)</li>
                                    <li>This is CRITICAL for your Mars in 12th house!</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Finance Tab -->
                    <div class="tab-pane fade" id="finance" role="tabpanel">
                        <div class="category-tab">
                            <div class="category-icon">üí∞</div>
                            <h3>Finance & Money</h3>
                            
                            <div class="row g-3 mt-3">
                                <div class="col-md-3">
                                    <label class="form-label">Income (‚Çπ)</label>
                                    <input type="number" class="form-control" id="income" min="0" placeholder="0">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Expenses (‚Çπ)</label>
                                    <input type="number" class="form-control" id="expenses" min="0" placeholder="0">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Savings (‚Çπ)</label>
                                    <input type="number" class="form-control" id="savings" min="0" placeholder="0">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Investments (‚Çπ)</label>
                                    <input type="number" class="form-control" id="investments" min="0" placeholder="0">
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Finance Notes</label>
                                    <textarea class="form-control" id="financeNotes" rows="2" placeholder="Transactions, investments, savings..."></textarea>
                                </div>
                            </div>

                            <!-- Financial Goals -->
                            <div class="alert alert-primary mt-4">
                                <strong>üí∞ Financial Goals:</strong>
                                <ul class="mb-0 mt-2">
                                    <li>Current Salary: ‚Çπ24 LPA (‚Çπ2L/month)</li>
                                    <li>2027: ‚Çπ40 LPA (Bangalore)</li>
                                    <li>2030: ‚Çπ1 Cr net worth</li>
                                    <li>2056: ‚Çπ75 Cr net worth (retirement)</li>
                                    <li>Monthly Invest: ‚Çπ47,500 (50% of income)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Family Tab -->
                    <div class="tab-pane fade" id="family" role="tabpanel">
                        <div class="category-tab">
                            <div class="category-icon">üë®‚Äçüë©‚Äçüëß</div>
                            <h3>Family & Social</h3>
                            
                            <div class="row g-3 mt-3">
                                <div class="col-md-4">
                                    <label class="form-label">Parents Time (min)</label>
                                    <input type="number" class="form-control" id="parentsTime" min="0" placeholder="30">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Social Time (min)</label>
                                    <input type="number" class="form-control" id="socialTime" min="0" placeholder="30">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Energy Level (1-10)</label>
                                    <input type="number" class="form-control" id="energy" min="1" max="10" placeholder="5">
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Family Notes</label>
                                    <textarea class="form-control" id="familyNotes" rows="2" placeholder="Activities, conversations, quality time..."></textarea>
                                </div>
                            </div>

                            <!-- Family Goals -->
                            <div class="alert alert-info mt-4">
                                <strong>üë®‚Äçüë©‚Äçüëß Family Goals:</strong>
                                <ul class="mb-0 mt-2">
                                    <li>Marriage: 2027-2029 (Age 31-33)</li>
                                    <li>First Child: 2029-2031 (Son)</li>
                                    <li>Second Child: 2033-2035 (Daughter)</li>
                                    <li>Home Purchase: 2028-2030 (‚Çπ80L-1.2 Cr)</li>
                                    <li>Temple Building: 2027-2028 (‚Çπ5-25L)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Vehicle Tab -->
                    <div class="tab-pane fade" id="vehicle" role="tabpanel">
                        <div class="category-tab">
                            <div class="category-icon">üöó</div>
                            <h3>Vehicle & Travel</h3>
                            
                            <div class="row g-3 mt-3">
                                <div class="col-md-6">
                                    <label class="form-label">Distance Traveled (km)</label>
                                    <input type="number" class="form-control" id="distanceTraveled" min="0" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Fuel Cost (‚Çπ)</label>
                                    <input type="number" class="form-control" id="fuelCost" min="0" placeholder="0">
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Vehicle/Travel Notes</label>
                                    <textarea class="form-control" id="vehicleNotes" rows="2" placeholder="Trips, maintenance, observations..."></textarea>
                                </div>
                            </div>

                            <!-- Vehicle Recommendations -->
                            <div class="alert alert-danger mt-4">
                                <strong>üöó Vehicle Recommendations:</strong>
                                <ul class="mb-0 mt-2">
                                    <li><strong>YOU (Mars in 12th):</strong> Honda Activa 6G (Scooter) - ‚Çπ77k</li>
                                    <li><strong>NOT Motorcycle!</strong> Mars in 12th = High accident risk</li>
                                    <li><strong>Purchase Date:</strong> Nov 21, 2025 (Friday, Rohini)</li>
                                    <li><strong>Color:</strong> Pearl White / Matte Grey</li>
                                    <li><strong>Brother:</strong> Yamaha FZ-S V4 (Motorcycle) - ‚Çπ1.17L</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="row mt-4">
                    <div class="col-12 text-center">
                        <button class="btn btn-primary btn-lg px-5" onclick="saveDaily()">
                            <i class="fas fa-save me-2"></i>Save Today's Log
                        </button>
                        <button class="btn btn-outline-secondary btn-lg px-5 ms-3" onclick="loadToday()">
                            <i class="fas fa-sync me-2"></i>Load Today's Data
                        </button>
                        <a href="dashboard.html" class="btn btn-outline-primary btn-lg px-5 ms-3">
                            <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Save Button -->
    <button class="btn btn-success save-btn" onclick="saveDaily()" title="Quick Save">
        <i class="fas fa-save fa-lg"></i>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_URL = 'https://yogesh-life-blueprint-production.up.railway.app/api';
        
        // Set current date
        document.getElementById('currentDate').innerText = new Date().toLocaleDateString('en-IN', { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        });

        // Load today's data on page load
        window.onload = () => {
            loadToday();
        };

        async function saveDaily() {
            const data = {
                date: new Date().toISOString().split('T')[0],
                career: {
                    hoursWorked: parseFloat(document.getElementById('hoursWorked').value) || 0,
                    leetcodeProblems: parseInt(document.getElementById('leetcodeProblems').value) || 0,
                    learningHours: parseFloat(document.getElementById('learningHours').value) || 0,
                    projectsWorked: document.getElementById('projectsWorked').value.split(',').map(p => p.trim()).filter(p => p),
                    jobApplications: parseInt(document.getElementById('jobApplications').value) || 0,
                    interviews: parseInt(document.getElementById('interviews').value) || 0,
                    notes: document.getElementById('careerNotes').value
                },
                health: {
                    weight: parseFloat(document.getElementById('weight').value) || null,
                    exercise: {
                        cardio: parseInt(document.getElementById('cardio').value) || 0,
                        strength: parseInt(document.getElementById('strength').value) || 0,
                        yoga: parseInt(document.getElementById('yoga').value) || 0
                    },
                    calories: parseInt(document.getElementById('calories').value) || null,
                    water: parseInt(document.getElementById('water').value) || 0,
                    sleep: parseFloat(document.getElementById('sleep').value) || 0,
                    meals: {
                        breakfast: document.getElementById('meals').value
                    },
                    notes: document.getElementById('healthNotes').value
                },
                spiritual: {
                    hanumanChalisa: parseInt(document.getElementById('hanumanChalisa').value) || 0,
                    meditation: parseInt(document.getElementById('meditation').value) || 0,
                    prayer: parseInt(document.getElementById('prayer').value) || 0,
                    templeVisit: document.getElementById('templeVisit').value === 'true',
                    notes: document.getElementById('spiritualNotes').value
                },
                finance: {
                    income: parseFloat(document.getElementById('income').value) || 0,
                    expenses: parseFloat(document.getElementById('expenses').value) || 0,
                    savings: parseFloat(document.getElementById('savings').value) || 0,
                    investments: parseFloat(document.getElementById('investments').value) || 0,
                    notes: document.getElementById('financeNotes').value
                },
                family: {
                    parentsTime: parseInt(document.getElementById('parentsTime').value) || 0,
                    socialTime: parseInt(document.getElementById('socialTime').value) || 0,
                    notes: document.getElementById('familyNotes').value
                },
                mood: document.getElementById('mood').value,
                energy: parseInt(document.getElementById('energy').value) || 5,
                notes: `Vehicle: ${document.getElementById('vehicleNotes').value || 'N/A'}`
            };

            try {
                const response = await fetch(`${API_URL}/daily-logs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const result = await response.json();
                    document.getElementById('dailyScore').innerText = `${result.score || 0}/100`;
                    alert('‚úÖ Daily log saved successfully!');
                } else {
                    alert('‚ö†Ô∏è Could not save. Make sure backend is running!');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå Error saving data. Check if backend is running on https://yogesh-life-blueprint-production.up.railway.app');
            }
        }

        async function loadToday() {
            const today = new Date().toISOString().split('T')[0];
            
            try {
                const response = await fetch(`${API_URL}/daily-logs/${today}`);
                
                if (response.ok) {
                    const result = await response.json();
                    const log = result.log;
                    
                    // Load career data
                    document.getElementById('hoursWorked').value = log.career.hoursWorked || '';
                    document.getElementById('leetcodeProblems').value = log.career.leetcodeProblems || '';
                    document.getElementById('learningHours').value = log.career.learningHours || '';
                    document.getElementById('projectsWorked').value = (log.career.projectsWorked || []).join(', ');
                    document.getElementById('jobApplications').value = log.career.jobApplications || '';
                    document.getElementById('interviews').value = log.career.interviews || '';
                    document.getElementById('careerNotes').value = log.career.notes || '';
                    
                    // Load health data
                    document.getElementById('weight').value = log.health.weight || '';
                    document.getElementById('cardio').value = log.health.exercise?.cardio || '';
                    document.getElementById('strength').value = log.health.exercise?.strength || '';
                    document.getElementById('yoga').value = log.health.exercise?.yoga || '';
                    document.getElementById('calories').value = log.health.calories || '';
                    document.getElementById('water').value = log.health.water || '';
                    document.getElementById('sleep').value = log.health.sleep || '';
                    document.getElementById('meals').value = log.health.meals?.breakfast || '';
                    document.getElementById('healthNotes').value = log.health.notes || '';
                    
                    // Load spiritual data
                    document.getElementById('hanumanChalisa').value = log.spiritual.hanumanChalisa || '';
                    document.getElementById('meditation').value = log.spiritual.meditation || '';
                    document.getElementById('prayer').value = log.spiritual.prayer || '';
                    document.getElementById('templeVisit').value = log.spiritual.templeVisit ? 'true' : 'false';
                    document.getElementById('spiritualNotes').value = log.spiritual.notes || '';
                    
                    // Load finance data
                    document.getElementById('income').value = log.finance.income || '';
                    document.getElementById('expenses').value = log.finance.expenses || '';
                    document.getElementById('savings').value = log.finance.savings || '';
                    document.getElementById('investments').value = log.finance.investments || '';
                    document.getElementById('financeNotes').value = log.finance.notes || '';
                    
                    // Load family data
                    document.getElementById('parentsTime').value = log.family.parentsTime || '';
                    document.getElementById('socialTime').value = log.family.socialTime || '';
                    document.getElementById('familyNotes').value = log.family.notes || '';
                    
                    // Load mood and energy
                    document.getElementById('mood').value = log.mood || 'good';
                    document.getElementById('energy').value = log.energy || 5;
                    
                    // Update score
                    document.getElementById('dailyScore').innerText = `${result.score || 0}/100`;
                    
                    console.log('‚úÖ Data loaded successfully!');
                }
            } catch (error) {
                console.log('No data found for today or backend not running');
            }
        }
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", async function() {
            await PageInit.init();
            AOS.init({ duration: 1000, once: true });
        });
    </script>
</body>
</html>

